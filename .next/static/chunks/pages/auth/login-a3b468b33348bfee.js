(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9344],{40163:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth/login",function(){return s(17505)}])},68809:function(e,t,s){"use strict";var r=s(85893),a=s(60129);t.Z=e=>{let{children:t}=e;return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex flex-col",children:[(0,r.jsx)("main",{className:"flex-grow",children:t}),(0,r.jsx)(a.x,{})]})}},13749:function(e,t,s){"use strict";s.d(t,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return n},aY:function(){return d},eW:function(){return u},ll:function(){return l}});var r=s(85893),a=s(67294),o=s(44531);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("rounded-xl border dark:border-gray-700 bg-card text-card-foreground shadow",s),...a})});n.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",s),...a})});i.displayName="CardHeader";let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("font-semibold leading-none tracking-tight",s),...a})});l.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",s),...a})});c.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",s),...a})});d.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",s),...a})});u.displayName="CardFooter"},35037:function(e,t,s){"use strict";s.d(t,{I:function(){return n}});var r=s(85893),a=s(67294),o=s(44531);let n=a.forwardRef((e,t)=>{let{className:s,type:a,...n}=e;return(0,r.jsx)("input",{type:a,className:(0,o.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:disabled:bg-gray-700",s),ref:t,...n})});n.displayName="Input"},71312:function(e,t,s){"use strict";s.d(t,{T:function(){return l}});var r=s(85893),a=s(58532),o=s(90250),n=s(87249),i=s(70749);function l(){let{theme:e,setTheme:t}=(0,i.F)();return console.log("ThemeToggle: Current theme is",e),(0,r.jsxs)(n.z,{variant:"ghost",size:"icon",className:"rounded-full h-9 w-9",onClick:()=>{console.log("ThemeToggle: Toggling theme from",e,"to","light"===e?"dark":"light"),t("light"===e?"dark":"light")},children:[(0,r.jsx)(a.Z,{className:"h-5 w-5 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),(0,r.jsx)(o.Z,{className:"absolute h-5 w-5 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),(0,r.jsx)("span",{className:"sr-only",children:"Toggle theme"})]})}},17505:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return S}});var r=s(85893),a=s(33299),o=s(11163),n=s(67294),i=s(87249),l=s(35037),c=s(13749),d=s(23217),u=s(45977),m=s(66);let p={spinner:d.Z,lock:u.Z,chart:m.Z};var g=s(25675),x=s.n(g),f=s(94933),h=s(11607),b=s(34464),v=s(9008),j=s.n(v),w=s(68809),N=s(70749),y=s(71312);let k=s(4147);function S(){let e=(0,o.useRouter)(),[t,d]=(0,n.useState)(null),[u,m]=(0,n.useState)(!1),[g,v]=(0,n.useState)(!1),{callbackUrl:S,error:L,expired:E}=e.query,{theme:C}=(0,N.F)();console.log("Login: Current theme is",C),(0,n.useEffect)(()=>{L&&"AccountDeactivated"===L&&d("Your account has been deactivated. Please contact an administrator for assistance."),"true"===E&&(d("Your session has expired. Please login again."),console.log("[Login] Session expired, redirected from:",S))},[L,E,S]);let T=async e=>{e.preventDefault(),m(!0);let t=new FormData(e.currentTarget),r=t.get("username");try{console.log("[Login] Attempt with callbackUrl:",S);let e=S?"string"==typeof S?S:S[0]:"/dashboard";console.log("[Login] Redirect destination:",e);let o=await (0,a.signIn)("credentials",{username:r,password:t.get("password"),redirect:!1,callbackUrl:e});if(console.log("[Login] SignIn result:",JSON.stringify({ok:null==o?void 0:o.ok,error:null==o?void 0:o.error,url:null==o?void 0:o.url,status:null==o?void 0:o.status})),null==o?void 0:o.error)console.error("[Login] Error:",o.error),o.error.toLowerCase().includes("inactive")?d("This account has been deactivated. Please contact an administrator."):d("Invalid credentials");else{console.log("[Login] Successful, fetching session data");try{console.log("[Login] ===== SESSION DEBUG START ====="),console.log("[Login] Browser cookies:",document.cookie),console.log("[Login] Current origin:",window.location.origin),console.log("[Login] Next-Auth path:","/api/auth/session"),console.log("[Login] Headers:",{cookie:document.cookie,"content-type":"application/json"});let t=await fetch("/api/auth/session",{headers:{"Content-Type":"application/json"},credentials:"include"});console.log("[Login] Session response status:",t.status),console.log("[Login] Session response headers:",Object.fromEntries([...t.headers.entries()]));let r=await t.json();console.log("[Login] Session data received:",JSON.stringify(r)),console.log("[Login] Session data type:",typeof r),console.log("[Login] Session data has user:",!!(null==r?void 0:r.user)),console.log("[Login] ===== SESSION DEBUG END =====");let{UserSession:a}=await Promise.resolve().then(s.bind(s,98225));if(null==r?void 0:r.user)console.log("[Login] Storing user session data in local storage",r.user),a.storeSession(r.user);else{console.error("[Login] No user data in session response"),d("Error retrieving user session");return}await new Promise(e=>setTimeout(e,1e3)),console.log("[Login] Cookies after session storage:",document.cookie),console.log("[Login] Redirecting to:",e),e.startsWith("/")?window.location.href=window.location.origin+e:window.location.href=e}catch(e){console.error("[Login] Error fetching session:",e),d("Error retrieving user session")}}}catch(e){console.error("[Login] Error during login process:",e),d("An error occurred during login")}finally{m(!1)}};return(0,r.jsxs)(w.Z,{children:[(0,r.jsx)(j(),{children:(0,r.jsx)("title",{children:"Login - P-Chart System"})}),(0,r.jsx)("div",{className:"flex min-h-[calc(100vh-2rem)] items-center justify-center px-4 dark:bg-black dark:border-white",children:(0,r.jsx)(c.Zb,{className:"w-full max-w-[440px] mx-auto bg-primary/5",children:(0,r.jsxs)(c.aY,{className:"space-y-6 p-8",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"flex items-center justify-center",children:(0,r.jsx)("div",{className:"relative w-[180px] h-[120px]",children:(0,r.jsx)(x(),{src:"dark"===C?"/jae-logo-white.png":"/jae-logo.png",alt:"JAE Logo",fill:!0,sizes:"180px",priority:!0,className:"object-contain"})})}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-center text-foreground dark:text-white",children:"P-CHART SYSTEM"}),(0,r.jsx)("p",{className:"text-muted-foreground text-center",children:"Welcome back! Please login to your account."})]}),(0,r.jsxs)("form",{onSubmit:T,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Username"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(l.I,{name:"username",type:"text",required:!0,placeholder:"Enter your username",disabled:u,className:"pl-8 h-9"}),(0,r.jsx)(f.Z,{className:"absolute left-2.5 top-2 h-4 w-4 text-muted-foreground"})]})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-foreground",children:"Password"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(l.I,{name:"password",type:g?"text":"password",required:!0,placeholder:"••••",disabled:u,className:"pl-8 pr-8 h-9"}),(0,r.jsx)(p.lock,{className:"absolute left-2.5 top-2 h-4 w-4 text-muted-foreground"}),(0,r.jsx)("button",{type:"button",onClick:()=>v(!g),className:"absolute right-2.5 top-2 text-muted-foreground hover:text-foreground",tabIndex:-1,children:g?(0,r.jsx)(h.Z,{className:"h-4 w-4"}):(0,r.jsx)(b.Z,{className:"h-4 w-4"})})]})]}),t&&(0,r.jsx)("div",{className:"text-sm ".concat(t.includes("deactivated")||t.includes("expired")?"bg-amber-100 p-3 rounded border border-amber-300":""," text-destructive text-center font-medium"),children:t}),(0,r.jsxs)(i.z,{type:"submit",disabled:u,className:"w-full h-10 bg-primary hover:bg-primary/90 text-primary-foreground rounded text-sm font-medium",children:[u&&(0,r.jsx)(p.spinner,{className:"mr-2 h-4 w-4 animate-spin"}),u?"SIGNING IN...":"LOGIN"]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,r.jsxs)("span",{className:"text-muted-foreground",children:["Version v",k.version]}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)(y.T,{})})]}),(0,r.jsxs)("div",{className:"pt-4 mt-4 border-t border-border text-xs text-muted-foreground text-center",children:[(0,r.jsx)("p",{children:"P-Chart System - Production Monitoring Web Application"}),(0,r.jsxs)("p",{children:["Developed by ",(0,r.jsx)("a",{href:"https://www.lechamp.com.sg/",target:"_blank",rel:"noopener noreferrer",className:"hover:text-primary",children:"LE CHAMP (South East Asia) Pte Ltd"})," | For ",(0,r.jsx)("a",{href:"https://www.jae.com/en/",target:"_blank",rel:"noopener noreferrer",className:"hover:text-primary",children:"JAE Philippines"})]}),(0,r.jsxs)("p",{className:"mt-1",children:["\xa9 ",new Date().getFullYear()," All rights reserved."]})]})]})})})]})}},4147:function(e){"use strict";e.exports=JSON.parse('{"name":"p_chart_web","version":"2.0.7","private":true,"prisma":{"seed":"ts-node prisma/seed.ts"},"scripts":{"dev":"next dev","build":"next build","start":"node .next/standalone/server.js","start:dev":"next start","start:port":"node .next/standalone/server.js","lint":"next lint","test:session":"node scripts/test-session-cli.js","test:db":"ts-node scripts/test-db-connection.ts","test:db-simple":"node test-db.js","generate:test-data":"ts-node scripts/generate-test-data.ts","generate:test-notifications":"ts-node scripts/generate-test-notifications.ts","generate:broadcast-notifications":"ts-node scripts/generate-test-notifications.ts --all","migrate-defect-names":"ts-node scripts/migrate-defect-names.ts","sync-production-data":"node scripts/production-data-import.js","seed-standard-costs":"ts-node scripts/seed-standard-costs.ts","generate-standard-costs-sample":"ts-node scripts/generate-standard-costs-sample.ts","test":"echo \\"No tests specified\\" && exit 0"},"dependencies":{"@auth/prisma-adapter":"^1.0.14","@hookform/resolvers":"^3.3.4","@prisma/client":"^5.8.1","@radix-ui/react-accordion":"^1.2.4","@radix-ui/react-alert-dialog":"^1.1.6","@radix-ui/react-avatar":"^1.0.4","@radix-ui/react-checkbox":"^1.1.4","@radix-ui/react-dialog":"^1.0.5","@radix-ui/react-dropdown-menu":"^2.1.5","@radix-ui/react-hover-card":"^1.1.7","@radix-ui/react-icons":"^1.3.0","@radix-ui/react-label":"^2.1.1","@radix-ui/react-popover":"^1.1.6","@radix-ui/react-progress":"^1.1.7","@radix-ui/react-select":"^2.0.0","@radix-ui/react-separator":"^1.1.3","@radix-ui/react-slot":"^1.1.1","@radix-ui/react-tabs":"^1.0.4","@radix-ui/react-toast":"^1.1.5","@radix-ui/react-tooltip":"^1.1.8","@tanstack/react-table":"^8.21.2","@types/adm-zip":"^0.5.7","@types/formidable":"^3.4.5","adm-zip":"^0.5.16","axios":"^1.8.4","bcryptjs":"^2.4.3","class-variance-authority":"^0.7.1","clsx":"^2.1.1","csv-parse":"^5.6.0","date-fns":"^4.1.0","dateformat":"^5.0.3","dotenv":"^16.5.0","exceljs":"^4.4.0","formidable":"^3.5.4","googleapis":"^150.0.1","lodash":"^4.17.21","lucide-react":"^0.312.0","multer":"^1.4.5-lts.2","mysql2":"^3.14.2","next":"latest","next-auth":"^4.24.5","node-windows":"^1.0.0-beta.8","pg":"^8.16.3","react":"latest","react-dom":"latest","react-dropzone":"^14.3.8","react-error-boundary":"^5.0.0","react-hook-form":"^7.49.3","react-hot-toast":"^2.5.2","recharts":"^2.15.1","sharp":"^0.34.2","socket.io":"^4.8.1","socket.io-client":"^4.8.1","tailwind-merge":"^2.6.0","tailwindcss-animate":"^1.0.7","xlsx":"^0.18.5","zod":"^3.22.4"},"devDependencies":{"@tailwindcss/postcss":"^4.1.3","@types/axios":"^0.9.36","@types/bcryptjs":"^2.4.6","@types/dateformat":"^5.0.3","@types/exceljs":"^0.5.3","@types/lodash":"^4.17.16","@types/multer":"^1.4.12","@types/node":"^20","@types/react":"^18","@types/react-dom":"^18","@types/xlsx":"^0.0.35","autoprefixer":"latest","eslint":"^8","eslint-config-next":"14.1.0","node-fetch":"^2.7.0","postcss":"latest","prisma":"^5.22.0","tailwindcss":"3.3.5","ts-node":"^10.9.2","typescript":"latest"}}')}},function(e){e.O(0,[2721,2888,9774,179],function(){return e(e.s=40163)}),_N_E=e.O()}]);