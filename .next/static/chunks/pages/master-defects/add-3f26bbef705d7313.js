(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[680],{8826:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/master-defects/add",function(){return r(84251)}])},45847:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var n=r(85893),a=r(89630),s=r(5716);function l(e){let{children:t}=e;return(0,n.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,n.jsx)(a.Z,{}),(0,n.jsx)("main",{className:"flex-1",children:(0,n.jsx)("div",{className:"container",children:t})}),(0,n.jsx)(s.Z,{})]})}},33566:function(e,t,r){"use strict";var n=r(85893);r(67294);var a=r(87764),s=r(35037);t.Z=e=>{let{title:t,description:r,searchPlaceholder:l="Search...",searchValue:i="",onSearchChange:o,actions:c}=e;return console.log("PageHeader: Rendering for ".concat(t)),(0,n.jsx)("div",{className:"w-full",children:(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold text-purple-700",children:t}),r&&(0,n.jsx)("p",{className:"text-gray-600 mt-1",children:r})]}),(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[o&&(0,n.jsxs)("div",{className:"relative w-96",children:[(0,n.jsx)(a.Z,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-500"}),(0,n.jsx)(s.I,{type:"search",placeholder:l,className:"pl-8",value:i,onChange:o})]}),c]})]})})}},50835:function(e,t,r){"use strict";r.d(t,{NI:function(){return h},Wi:function(){return u},l0:function(){return c},lX:function(){return x},pf:function(){return j},xJ:function(){return p},zG:function(){return y}});var n=r(85893),a=r(67294),s=r(88426),l=r(87536),i=r(44531),o=r(2297);let c=l.RV,d=a.createContext({}),u=e=>{let{...t}=e;return(0,n.jsx)(d.Provider,{value:{name:t.name},children:(0,n.jsx)(l.Qr,{...t})})},f=()=>{let e=a.useContext(d),t=a.useContext(m),{getFieldState:r,formState:n}=(0,l.Gc)(),s=r(e.name,n);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=t;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...s}},m=a.createContext({}),p=a.forwardRef((e,t)=>{let{className:r,...s}=e,l=a.useId();return(0,n.jsx)(m.Provider,{value:{id:l},children:(0,n.jsx)("div",{ref:t,className:(0,i.cn)("space-y-2",r),...s})})});p.displayName="FormItem";let x=a.forwardRef((e,t)=>{let{className:r,...a}=e,{error:s,formItemId:l}=f();return(0,n.jsx)(o._,{ref:t,className:(0,i.cn)(s&&"text-destructive",r),htmlFor:l,...a})});x.displayName="FormLabel";let h=a.forwardRef((e,t)=>{let{...r}=e,{error:a,formItemId:l,formDescriptionId:i,formMessageId:o}=f();return(0,n.jsx)(s.g7,{ref:t,id:l,"aria-describedby":a?"".concat(i," ").concat(o):"".concat(i),"aria-invalid":!!a,...r})});h.displayName="FormControl";let j=a.forwardRef((e,t)=>{let{className:r,...a}=e,{formDescriptionId:s}=f();return(0,n.jsx)("p",{ref:t,id:s,className:(0,i.cn)("text-[0.8rem] text-muted-foreground",r),...a})});j.displayName="FormDescription";let y=a.forwardRef((e,t)=>{let{className:r,children:a,...s}=e,{error:l,formMessageId:o}=f(),c=l?String(null==l?void 0:l.message):a;return c?(0,n.jsx)("p",{ref:t,id:o,className:(0,i.cn)("text-[0.8rem] font-medium text-destructive",r),...s,children:c}):null});y.displayName="FormMessage"},2297:function(e,t,r){"use strict";r.d(t,{_:function(){return c}});var n=r(85893),a=r(67294),s=r(49102),l=r(12003),i=r(44531);let o=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(s.f,{ref:t,className:(0,i.cn)(o(),r),...a})});c.displayName=s.f.displayName},54462:function(e,t,r){"use strict";r.d(t,{Bw:function(){return x},Ph:function(){return d},Ql:function(){return h},i4:function(){return f},ki:function(){return u}});var n=r(85893),a=r(67294),s=r(85872),l=r(8971),i=r(84979),o=r(13742),c=r(44531);let d=s.fC;s.ZA;let u=s.B4,f=a.forwardRef((e,t)=>{let{className:r,children:a,...i}=e;return(0,n.jsxs)(s.xz,{ref:t,className:(0,c.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...i,children:[a,(0,n.jsx)(s.JO,{asChild:!0,children:(0,n.jsx)(l.Z,{className:"h-4 w-4 opacity-50"})})]})});f.displayName=s.xz.displayName;let m=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(s.u_,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",r),...a,children:(0,n.jsx)(i.Z,{className:"h-4 w-4"})})});m.displayName=s.u_.displayName;let p=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(s.$G,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",r),...a,children:(0,n.jsx)(l.Z,{className:"h-4 w-4"})})});p.displayName=s.$G.displayName;let x=a.forwardRef((e,t)=>{let{className:r,children:a,position:l="popper",...i}=e;return(0,n.jsx)(s.h_,{children:(0,n.jsxs)(s.VY,{ref:t,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:l,...i,children:[(0,n.jsx)(m,{}),(0,n.jsx)(s.l_,{className:(0,c.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,n.jsx)(p,{})]})})});x.displayName=s.VY.displayName,a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(s.__,{ref:t,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",r),...a})}).displayName=s.__.displayName;let h=a.forwardRef((e,t)=>{let{className:r,children:a,...l}=e;return(0,n.jsxs)(s.ck,{ref:t,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...l,children:[(0,n.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(s.wU,{children:(0,n.jsx)(o.Z,{className:"h-4 w-4"})})}),(0,n.jsx)(s.eT,{children:a})]})});h.displayName=s.ck.displayName,a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(s.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",r),...a})}).displayName=s.Z0.displayName},65765:function(e,t,r){"use strict";r.d(t,{g:function(){return l}});var n=r(85893),a=r(67294),s=r(44531);let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("textarea",{className:(0,s.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...a})});l.displayName="Textarea"},84251:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Q}});var n=r(85893),a=r(67294),s=r(11163),l=r(56312),i=r(87536),o=r(1604),c=r(98225),d=r(87249),u=r(50835),f=r(35037),m=r(65765),p=r(54462),x=r(28771),h=r(25360),j=r(36206),y=r(77342),g=r(57898),b=r(7546),w=r(29115);r(73935);var N=a.forwardRef((e,t)=>{let{children:r,...s}=e,l=a.Children.toArray(r),i=l.find(C);if(i){let e=i.props.children,r=l.map(t=>t!==i?t:a.Children.count(e)>1?a.Children.only(null):a.isValidElement(e)?e.props.children:null);return(0,n.jsx)(v,{...s,ref:t,children:a.isValidElement(e)?a.cloneElement(e,void 0,r):null})}return(0,n.jsx)(v,{...s,ref:t,children:r})});N.displayName="Slot";var v=a.forwardRef((e,t)=>{let{children:r,...n}=e;if(a.isValidElement(r)){let e,s;let l=(e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?r.props.ref:r.props.ref||r.ref,i=function(e,t){let r={...t};for(let n in t){let a=e[n],s=t[n];/^on[A-Z]/.test(n)?a&&s?r[n]=(...e)=>{s(...e),a(...e)}:a&&(r[n]=a):"style"===n?r[n]={...a,...s}:"className"===n&&(r[n]=[a,s].filter(Boolean).join(" "))}return{...e,...r}}(n,r.props);return r.type!==a.Fragment&&(i.ref=t?(0,x.F)(t,l):l),a.cloneElement(r,i)}return a.Children.count(r)>1?a.Children.only(null):null});v.displayName="SlotClone";var k=({children:e})=>(0,n.jsx)(n.Fragment,{children:e});function C(e){return a.isValidElement(e)&&e.type===k}var R=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{let r=a.forwardRef((e,r)=>{let{asChild:a,...s}=e,l=a?N:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,n.jsx)(l,{...s,ref:r})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),E="Checkbox",[_,S]=(0,h.b)(E),[I,Z]=_(E),F=a.forwardRef((e,t)=>{let{__scopeCheckbox:r,name:s,checked:l,defaultChecked:i,required:o,disabled:c,value:d="on",onCheckedChange:u,form:f,...m}=e,[p,h]=a.useState(null),g=(0,x.e)(t,e=>h(e)),b=a.useRef(!1),w=!p||f||!!p.closest("form"),[N=!1,v]=(0,y.T)({prop:l,defaultProp:i,onChange:u}),k=a.useRef(N);return a.useEffect(()=>{let e=p?.form;if(e){let t=()=>v(k.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[p,v]),(0,n.jsxs)(I,{scope:r,state:N,disabled:c,children:[(0,n.jsx)(R.button,{type:"button",role:"checkbox","aria-checked":M(N)?"mixed":N,"aria-required":o,"data-state":D(N),"data-disabled":c?"":void 0,disabled:c,value:d,...m,ref:g,onKeyDown:(0,j.M)(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,j.M)(e.onClick,e=>{v(e=>!!M(e)||!e),w&&(b.current=e.isPropagationStopped(),b.current||e.stopPropagation())})}),w&&(0,n.jsx)(z,{control:p,bubbles:!b.current,name:s,value:d,checked:N,required:o,disabled:c,form:f,style:{transform:"translateX(-100%)"},defaultChecked:!M(i)&&i})]})});F.displayName=E;var P="CheckboxIndicator",O=a.forwardRef((e,t)=>{let{__scopeCheckbox:r,forceMount:a,...s}=e,l=Z(P,r);return(0,n.jsx)(w.z,{present:a||M(l.state)||!0===l.state,children:(0,n.jsx)(R.span,{"data-state":D(l.state),"data-disabled":l.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});O.displayName=P;var z=e=>{let{control:t,checked:r,bubbles:s=!0,defaultChecked:l,...i}=e,o=a.useRef(null),c=(0,g.D)(r),d=(0,b.t)(t);a.useEffect(()=>{let e=o.current,t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(c!==r&&t){let n=new Event("click",{bubbles:s});e.indeterminate=M(r),t.call(e,!M(r)&&r),e.dispatchEvent(n)}},[c,r,s]);let u=a.useRef(!M(r)&&r);return(0,n.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:l??u.current,...i,tabIndex:-1,ref:o,style:{...e.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function M(e){return"indeterminate"===e}function D(e){return M(e)?"indeterminate":e?"checked":"unchecked"}var T=r(13742),V=r(44531);let W=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(F,{ref:t,className:(0,V.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...a,children:(0,n.jsx)(O,{className:(0,V.cn)("flex items-center justify-center text-current"),children:(0,n.jsx)(T.Z,{className:"h-4 w-4"})})})});W.displayName=F.displayName;var X=r(45847),G=r(33566);let J=o.Ry({name:o.Z_().min(1,"Name is required"),description:o.Z_().optional(),category:o.Z_().min(1,"Category is required"),applicableOperation:o.Z_().min(1,"Operation is required"),reworkable:o.O7().default(!1),machine:o.Z_().optional()});var Q=(0,c.c2)(function(){let e=(0,s.useRouter)(),[t,r]=(0,a.useState)(!1),[o,c]=(0,a.useState)(null),[x,h]=(0,a.useState)([]),[j,y]=(0,a.useState)([]),g=(0,i.cI)({resolver:(0,l.F)(J),defaultValues:{name:"",description:"",category:"",applicableOperation:"",reworkable:!1,machine:""}});async function b(t){r(!0),c(null);try{console.log("Submitting form with values:",t);let r=await fetch("/api/master-defects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok){let e=await r.json();throw Error(e.error||"Failed to create master defect")}console.log("Master defect created successfully"),e.push("/master-defects")}catch(e){console.error("Error creating master defect:",e),c(e.message||"Failed to create master defect. Please try again.")}finally{r(!1)}}return(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/master-defects");if(!e.ok)throw Error("Failed to fetch master defects");let t=await e.json(),r=[...new Set(t.data.map(e=>e.category).filter(Boolean))];y(r);let n=await fetch("/api/operation-steps");if(!n.ok)throw Error("Failed to fetch operation steps");let a=await n.json();h(a)}catch(e){console.error("Error fetching data:",e),c("Failed to load form data. Please try again later.")}})()},[]),(0,n.jsx)(X.Z,{children:(0,n.jsxs)("div",{className:"container mx-auto py-6",children:[(0,n.jsx)(G.Z,{title:"Add Master Defect",description:"Create a new master defect in the system",actions:(0,n.jsx)(d.z,{onClick:()=>e.push("/master-defects"),variant:"outline",children:"Cancel"})}),o&&(0,n.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:o}),(0,n.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,n.jsx)(u.l0,{...g,children:(0,n.jsxs)("form",{onSubmit:g.handleSubmit(b),className:"space-y-6",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,n.jsx)(u.Wi,{control:g.control,name:"name",render:e=>{let{field:t}=e;return(0,n.jsxs)(u.xJ,{children:[(0,n.jsx)(u.lX,{children:"Name"}),(0,n.jsx)(u.NI,{children:(0,n.jsx)(f.I,{placeholder:"Enter defect name",...t})}),(0,n.jsx)(u.pf,{children:"Unique identifier for this master defect"}),(0,n.jsx)(u.zG,{})]})}}),(0,n.jsx)(u.Wi,{control:g.control,name:"category",render:e=>{let{field:t}=e;return(0,n.jsxs)(u.xJ,{children:[(0,n.jsx)(u.lX,{children:"Category"}),(0,n.jsx)(u.NI,{children:(0,n.jsxs)(p.Ph,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,n.jsx)(p.i4,{children:(0,n.jsx)(p.ki,{placeholder:"Select category"})}),(0,n.jsxs)(p.Bw,{children:[j.map(e=>(0,n.jsx)(p.Ql,{value:e,children:e},e)),(0,n.jsx)(p.Ql,{value:"SMT",children:"SMT"}),(0,n.jsx)(p.Ql,{value:"Assembly",children:"Assembly"}),(0,n.jsx)(p.Ql,{value:"Material",children:"Material"}),(0,n.jsx)(p.Ql,{value:"Soldering",children:"Soldering"}),(0,n.jsx)(p.Ql,{value:"Testing",children:"Testing"})]})]})}),(0,n.jsx)(u.zG,{})]})}}),(0,n.jsx)(u.Wi,{control:g.control,name:"applicableOperation",render:e=>{let{field:t}=e;return(0,n.jsxs)(u.xJ,{children:[(0,n.jsx)(u.lX,{children:"Applicable Operation"}),(0,n.jsx)(u.NI,{children:(0,n.jsxs)(p.Ph,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,n.jsx)(p.i4,{children:(0,n.jsx)(p.ki,{placeholder:"Select operation"})}),(0,n.jsx)(p.Bw,{children:x.map(e=>(0,n.jsxs)(p.Ql,{value:e.operationNumber,children:[e.operationNumber," - ",e.label]},e.operationNumber))})]})}),(0,n.jsx)(u.zG,{})]})}}),(0,n.jsx)(u.Wi,{control:g.control,name:"machine",render:e=>{let{field:t}=e;return(0,n.jsxs)(u.xJ,{children:[(0,n.jsx)(u.lX,{children:"Machine"}),(0,n.jsx)(u.NI,{children:(0,n.jsx)(f.I,{placeholder:"Enter machine type",...t})}),(0,n.jsx)(u.pf,{children:"Machine type associated with this defect (optional)"}),(0,n.jsx)(u.zG,{})]})}}),(0,n.jsx)(u.Wi,{control:g.control,name:"description",render:e=>{let{field:t}=e;return(0,n.jsxs)(u.xJ,{className:"col-span-2",children:[(0,n.jsx)(u.lX,{children:"Description"}),(0,n.jsx)(u.NI,{children:(0,n.jsx)(m.g,{placeholder:"Enter detailed description",className:"min-h-24",...t})}),(0,n.jsx)(u.zG,{})]})}}),(0,n.jsx)(u.Wi,{control:g.control,name:"reworkable",render:e=>{let{field:t}=e;return(0,n.jsxs)(u.xJ,{className:"flex flex-row items-start space-x-3 space-y-0 py-4",children:[(0,n.jsx)(u.NI,{children:(0,n.jsx)(W,{checked:t.value,onCheckedChange:t.onChange})}),(0,n.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,n.jsx)(u.lX,{children:"Reworkable"}),(0,n.jsx)(u.pf,{children:"Indicates if this type of defect can be reworked"})]})]})}})]}),(0,n.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,n.jsx)(d.z,{type:"button",variant:"outline",onClick:()=>e.push("/master-defects"),children:"Cancel"}),(0,n.jsx)(d.z,{type:"submit",disabled:t,className:"bg-purple-600 hover:bg-purple-700 text-white",children:t?"Creating...":"Create Master Defect"})]})]})})})]})})})}},function(e){e.O(0,[192,664,847,341,763,164,888,774,179],function(){return e(e.s=8826)}),_N_E=e.O()}]);