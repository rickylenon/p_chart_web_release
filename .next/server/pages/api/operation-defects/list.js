"use strict";(()=>{var e={};e.id=2718,e.ids=[2718],e.modules={53524:e=>{e.exports=require("@prisma/client")},98432:e=>{e.exports=require("bcryptjs")},60614:e=>{e.exports=require("next-auth/jwt")},62113:e=>{e.exports=require("next-auth/next")},47449:e=>{e.exports=require("next-auth/providers/credentials")},41649:e=>{e.exports=require("next-auth/react")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},97427:(e,r,t)=>{t.r(r),t.d(r,{config:()=>c,default:()=>l,routeModule:()=>p});var o={};t.r(o),t.d(o,{default:()=>d});var s=t(71802),n=t(47153),a=t(56249),i=t(44507);async function u(e,r,t){if(console.log("Operation Defects List API called"),"POST"===e.method)try{let o="string"==typeof e.body?JSON.parse(e.body):e.body;console.log("Fetching operation defects for operationId:",o.operationId);let{operationId:s}=o;if(!s)return r.status(400).json({error:"Operation ID is required"});console.log("Session data:",t?.user);let n=t?.user?.id;if(!n||"undefined"===n)return console.log("Invalid user ID in session:",n),r.status(401).json({error:"Invalid user session - please login again"});let a=parseInt(n);if(isNaN(a))return console.log("Failed to parse user ID:",n),r.status(401).json({error:"Invalid user ID format"});console.log("Authenticated user ID:",a);let u=await i.Z.operationDefect.findMany({where:{operationId:parseInt(s.toString())},include:{defect:!0,recordedBy:{select:{name:!0,email:!0}}}});return console.log(`Found ${u.length} defects for operation ${s}`),r.status(200).json({success:!0,data:u})}catch(e){return console.error("Error fetching operation defects:",e),r.status(500).json({error:e instanceof Error?e.message:"An unknown error occurred"})}return r.status(405).json({error:"Method not allowed"})}let d=(0,t(66826).QO)(u),l=(0,a.l)(o,"default"),c=(0,a.l)(o,"config"),p=new s.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/operation-defects/list",pathname:"/api/operation-defects/list",bundlePath:"",filename:""},userland:o})}};var r=require("../../../webpack-api-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[549],()=>t(97427));module.exports=o})();