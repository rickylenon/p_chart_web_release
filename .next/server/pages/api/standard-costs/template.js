"use strict";(()=>{var e={};e.id=2059,e.ids=[2059],e.modules={53524:e=>{e.exports=require("@prisma/client")},98432:e=>{e.exports=require("bcryptjs")},57641:e=>{e.exports=require("exceljs")},60614:e=>{e.exports=require("next-auth/jwt")},62113:e=>{e.exports=require("next-auth/next")},47449:e=>{e.exports=require("next-auth/providers/credentials")},41649:e=>{e.exports=require("next-auth/react")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},31155:(e,t,r)=>{r.r(t),r.d(t,{config:()=>m,default:()=>p,routeModule:()=>h});var o={};r.r(o),r.d(o,{default:()=>u});var s=r(71802),a=r(47153),n=r(56249),i=r(66826),l=r(57641),d=r.n(l);async function c(e,t,r){try{console.log("API: StandardCosts template auth session validated, user:",r?.user?.name);let o=r?.user?.role||"";if("admin"!==o.toLowerCase())return t.status(403).json({error:"Admin access required"});if("GET"===e.method)try{console.log("Generating standard costs template Excel file");let e=new(d()).Workbook,r=e.addWorksheet("Standard Costs Template");r.columns=[{header:"Item Name",key:"itemName",width:30},{header:"Description",key:"description",width:40},{header:"Cost Per Unit",key:"costPerUnit",width:15},{header:"Currency",key:"currency",width:12}];let o=r.getRow(1);o.font={bold:!0},o.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF4F46E5"}},o.font={bold:!0,color:{argb:"FFFFFFFF"}},o.eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),[{itemName:"ITEM001",description:"Example Item 1",costPerUnit:12.5,currency:"USD"},{itemName:"ITEM002",description:"Example Item 2",costPerUnit:25.75,currency:"USD"},{itemName:"ITEM003",description:"Example Item 3",costPerUnit:8.25,currency:"USD"}].forEach((e,t)=>{let o=r.addRow(e);o.eachCell((e,t)=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},3===t&&(e.numFmt="$#,##0.0000")}),o.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFEFF6FF"}}});let s=r.getRow(6);s.getCell(1).value="Instructions:",s.getCell(1).font={bold:!0},["1. Replace the example data above with your actual standard costs","2. Item Name is required and must be unique","3. Cost Per Unit must be a positive number","4. Currency defaults to USD if not specified","5. Description is optional but recommended","6. Delete these instruction rows before importing"].forEach((e,t)=>{let o=r.getRow(7+t);o.getCell(1).value=e,o.getCell(1).font={italic:!0}}),console.log("Template Excel file generated successfully"),t.setHeader("Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),t.setHeader("Content-Disposition",'attachment; filename="standard_costs_template.xlsx"');let a=await e.xlsx.writeBuffer();console.log("Template Excel file written to buffer, sending to client"),t.send(a)}catch(e){return console.error("Error generating template:",e),t.status(500).json({error:"Failed to generate template",details:e instanceof Error?e.message:"Unknown error"})}return t.status(405).json({error:"Method not allowed"})}catch(e){return console.error("Error in template handler:",e),t.status(500).json({error:"Failed to process request"})}}let u=(0,i.QO)(c),p=(0,n.l)(o,"default"),m=(0,n.l)(o,"config"),h=new s.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/standard-costs/template",pathname:"/api/standard-costs/template",bundlePath:"",filename:""},userland:o})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[549],()=>r(31155));module.exports=o})();