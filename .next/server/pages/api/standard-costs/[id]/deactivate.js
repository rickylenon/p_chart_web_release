"use strict";(()=>{var e={};e.id=9835,e.ids=[9835],e.modules={53524:e=>{e.exports=require("@prisma/client")},98432:e=>{e.exports=require("bcryptjs")},60614:e=>{e.exports=require("next-auth/jwt")},62113:e=>{e.exports=require("next-auth/next")},47449:e=>{e.exports=require("next-auth/providers/credentials")},41649:e=>{e.exports=require("next-auth/react")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},88317:(e,t,r)=>{r.r(t),r.d(t,{config:()=>l,default:()=>c,routeModule:()=>p});var a={};r.r(a),r.d(a,{default:()=>u});var s=r(71802),o=r(47153),d=r(56249),n=r(44507);async function i(e,t,r){try{console.log("API: StandardCosts deactivate auth session validated, user:",r?.user?.name);let{id:a}=e.query,s=parseInt(a,10);if(isNaN(s))return t.status(400).json({error:"Invalid standard cost ID"});let o=r?.user?.role||"";if("admin"!==o.toLowerCase())return t.status(403).json({error:"Admin access required"});if("PUT"===e.method)try{console.log(`Deactivating standard cost with ID: ${s}`);let e=await n.Z.standardCost.findUnique({where:{id:s}});if(!e)return t.status(404).json({error:"Standard cost not found"});if(!e.isActive)return t.status(400).json({error:"Standard cost is already inactive"});let a=r?.user?.id?parseInt(r.user.id):null,o=await n.Z.standardCost.update({where:{id:s},data:{isActive:!1,updatedById:a}});console.log(`Deactivated standard cost with ID: ${s}`);let d={...o,costPerUnit:Number(o.costPerUnit)};return t.status(200).json({message:"Standard cost deactivated successfully",standardCost:d})}catch(e){return console.error("Error deactivating standard cost:",e),t.status(500).json({error:"Failed to deactivate standard cost",details:e instanceof Error?e.message:"Unknown error"})}return t.status(405).json({error:"Method not allowed"})}catch(e){return console.error("Error in deactivate handler:",e),t.status(500).json({error:"Failed to process request"})}}let u=(0,r(66826).QO)(i),c=(0,d.l)(a,"default"),l=(0,d.l)(a,"config"),p=new s.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/standard-costs/[id]/deactivate",pathname:"/api/standard-costs/[id]/deactivate",bundlePath:"",filename:""},userland:a})}};var t=require("../../../../webpack-api-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[549],()=>r(88317));module.exports=a})();