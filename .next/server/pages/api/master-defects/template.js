"use strict";(()=>{var e={};e.id=3115,e.ids=[3115],e.modules={53524:e=>{e.exports=require("@prisma/client")},98432:e=>{e.exports=require("bcryptjs")},57641:e=>{e.exports=require("exceljs")},60614:e=>{e.exports=require("next-auth/jwt")},62113:e=>{e.exports=require("next-auth/next")},47449:e=>{e.exports=require("next-auth/providers/credentials")},41649:e=>{e.exports=require("next-auth/react")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},67200:(e,t,r)=>{r.r(t),r.d(t,{config:()=>u,default:()=>h,routeModule:()=>m});var o={};r.r(o),r.d(o,{default:()=>p});var a=r(71802),n=r(47153),i=r(56249),s=r(66826),l=r(57641),d=r.n(l);async function c(e,t,r){try{if(console.log("API: MasterDefects template download auth session validated, user:",r?.user?.name),"GET"!==e.method)return t.status(405).json({error:"Method not allowed"});console.log("Generating master defects import template");let o=new(d()).Workbook,a=o.addWorksheet("Master Defects Template");a.columns=[{header:"Name",key:"name",width:30},{header:"Description",key:"description",width:40},{header:"Category",key:"category",width:20},{header:"Operation",key:"operation",width:15},{header:"Machine",key:"machine",width:15},{header:"Reworkable",key:"reworkable",width:12},{header:"Status",key:"status",width:10}];let n=a.getRow(1);n.font={bold:!0},n.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF9CA3AF"}},n.eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});let i=[{name:"Missing Pin",description:"Pin is missing from connector",category:"Connector",operation:"OP20",machine:"Machine 1",reworkable:"Yes",status:"Active"},{name:"Broken Housing",description:"Housing has visible cracks or damage",category:"Housing",operation:"OP30",machine:"Machine 2",reworkable:"No",status:"Active"}];i.forEach(e=>{a.addRow(e)}),a.addRow({}),a.addRow({name:"Instructions:"}),a.addRow({name:"- Name and Category are required fields"}),a.addRow({name:'- Reworkable should be "Yes" or "No"'}),a.addRow({name:'- Status should be "Active" or "Inactive"'}),a.addRow({name:"- Operation should be the operation code (e.g., OP10, OP20)"});for(let e=a.rowCount-5;e<=a.rowCount;e++)a.getRow(e).getCell(1).font={italic:!0,color:{argb:"00555555"}};for(let e=2;e<=i.length+1;e++)a.getRow(e).eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});console.log("Template file generated, preparing for download"),t.setHeader("Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),t.setHeader("Content-Disposition","attachment; filename=master-defects-template.xlsx");let s=await o.xlsx.writeBuffer();console.log("Template file written to buffer, sending to client"),t.send(s)}catch(e){console.error("Error generating template file:",e),t.status(500).json({error:"Failed to generate template file"})}}let p=(0,s.QO)(c),h=(0,i.l)(o,"default"),u=(0,i.l)(o,"config"),m=new a.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/master-defects/template",pathname:"/api/master-defects/template",bundlePath:"",filename:""},userland:o})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[549],()=>r(67200));module.exports=o})();