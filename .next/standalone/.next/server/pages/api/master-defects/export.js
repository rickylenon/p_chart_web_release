"use strict";(()=>{var e={};e.id=3531,e.ids=[3531],e.modules={53524:e=>{e.exports=require("@prisma/client")},98432:e=>{e.exports=require("bcryptjs")},57641:e=>{e.exports=require("exceljs")},60614:e=>{e.exports=require("next-auth/jwt")},62113:e=>{e.exports=require("next-auth/next")},47449:e=>{e.exports=require("next-auth/providers/credentials")},41649:e=>{e.exports=require("next-auth/react")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3412:(e,t,r)=>{r.r(t),r.d(t,{config:()=>u,default:()=>f,routeModule:()=>m});var o={};r.r(o),r.d(o,{default:()=>h});var a=r(71802),i=r(47153),s=r(56249),n=r(66826),l=r(44507),d=r(57641),c=r.n(d);async function p(e,t,r){try{if(console.log("API: MasterDefects export auth session validated, user:",r?.user?.name),"GET"!==e.method)return t.status(405).json({error:"Method not allowed"});console.log("Exporting master defects to Excel");let o=await l._.masterDefect.findMany({orderBy:[{category:"asc"},{name:"asc"}]});console.log(`Found ${o.length} master defects to export`);let a=new(c()).Workbook,i=a.addWorksheet("Master Defects");i.columns=[{header:"Name",key:"name",width:30},{header:"Description",key:"description",width:40},{header:"Category",key:"category",width:20},{header:"Operation",key:"applicableOperation",width:15},{header:"Machine",key:"machine",width:15},{header:"Reworkable",key:"reworkable",width:12},{header:"Status",key:"isActive",width:10}];let s=i.getRow(1);s.font={bold:!0},s.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF9CA3AF"}},s.eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),o.forEach(e=>{i.addRow({name:e.name,description:e.description,category:e.category,applicableOperation:e.applicableOperation,machine:e.machine,reworkable:e.reworkable?"Yes":"No",isActive:e.isActive?"Active":"Inactive"})}),i.columns.forEach(e=>{e.width=e.width||20});for(let e=2;e<=o.length+1;e++){let t=i.getRow(e);t.eachCell(e=>{e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),e%2==0&&(t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF9FAFB"}})}console.log("Excel file generated, preparing for download"),t.setHeader("Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),t.setHeader("Content-Disposition","attachment; filename=master-defects.xlsx");let n=await a.xlsx.writeBuffer();console.log("Excel file written to buffer, sending to client"),t.send(n)}catch(e){console.error("Error exporting master defects to Excel:",e),t.status(500).json({error:"Failed to export master defects"})}}let h=(0,n.QO)(p),f=(0,s.l)(o,"default"),u=(0,s.l)(o,"config"),m=new a.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/master-defects/export",pathname:"/api/master-defects/export",bundlePath:"",filename:""},userland:o})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[549],()=>r(3412));module.exports=o})();